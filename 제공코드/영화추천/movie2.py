import numpy as np 
import pandas as pd
import json
from bs4 import BeautifulSoup
import pandas as pd
from urllib.request import urlopen
from mlxtend.preprocessing import TransactionEncoder
from mlxtend.frequent_patterns import apriori
#%%
urls = 'C:/Users/admin/Documents/5343448/'
#%%
lst = [['라라랜드', '나의 산티아고', '교회오빠'], ['어메이징 그레이스', '스윙키즈', '알라딘', '아이 필 프리티', '어벤져스: 엔드게임', '쇼생크 탈출', '튼튼이의 모험', '사바하', '극한직업', '교회오빠'], ['변호인', '패솔로지', '교회오빠'], ['나랏말싸미', '리틀 포레스트', '인천상륙작전', '제이슨 본', '도리를 찾아서', '나우 유 씨 미 2', '국가대표', '교회오빠'], ['뺑반', '신과함께-인과 연', '신과함께-죄와 벌', '무현, 두 도시 이야기', '암살', '도둑들', '솔트', '아이언맨', '교회오빠'], ['베테랑', '교회오빠'], ['어스', '사바하', '캡틴 마블', '베놈', '앤트맨과 와스프', '어벤져스: 인피니티 워', '블랙 팬서', '1987', '위대한 쇼맨', '교회오빠'], ['백두산', '82년생 김지영', '임을 위한 행진곡', '걸캅스', '물괴', '퍼스트레이디-그녀에게', '못난이 주의보', '교회오빠'], ['창수', '교회오빠'], ['항거:유관순 이야기', '수상한 그녀', '교회오빠'], ['그것만이 내 세상', '교회오빠'], ['독전', '안녕,헤이즐', '메이크 유어 무브', '가시', '교회오빠'], ['예수는 역사다', '더 킹', '쿵푸 팬더', '용서받지 못한 자', '교회오빠'], ['아바타', '교회오빠'], ['나이브스 아웃', '글래스', '서서평, 천천히 평온하게', '미녀와 야수', '맨 오브 스틸', '배트맨 대 슈퍼맨: 저스티스의 시작', '철의 여인', '라스트 에어벤더', '일라이', '교회오빠'], ['배심원들', '배심원들', '어벤져스: 엔드게임', '극한직업', '베놈', '서치', '명당', '협상', '안시성', '교회오빠'], ['기생충', '벤허', '캡틴 아메리카: 시빌 워', '교회오빠'], ['목격자', '알리타: 배틀 엔젤', '더 비지트', '모놀리스', '존 윅 - 리로드', '패닉 룸', '클로버필드', '명량', '도미노', '교회오빠'], ['어벤져스: 엔드게임', '생일', '교회오빠'], ['알라딘', '기생충', '어스', '보헤미안 랩소디', '1987', '아가씨', '곡성(哭聲)', '동주', '수상한 그녀', '교회오빠'], ['나를 찾아줘', '말모이', '허스토리', '패션 오브 크라이스트', '교회오빠'], ['유열의 음악앨범', '천로역정: 천국을 찾아서', '말모이', '곰돌이 푸 다시 만나 행복해', '너의 결혼식', '플로이', '맘마미아!2', '패딩턴 2', '스파이더맨: 홈커밍', '교회오빠'], ['힘을 내요, 미스터 리', '생일', '알리타: 배틀 엔젤', '극한직업', '안시성', '교회오빠'], ['걸캅스', '어벤져스: 엔드게임', '골든슬럼버', '교회오빠'], ['드래곤 프린세스', '스파키', '극장판 포켓몬스터DP - 디아루가 VS 펄기아 VS 다크라이', '극장판 포켓몬스터 너로 정했다!', '뽀로로 극장판 공룡섬 대모험', '래빗 스쿨', '꾼', '부라더', '배저로와 친구들: 신비한 모험', '교회오빠'], ['극한직업', '드래곤 길들이기 3', '항거:유관순 이야기', '알라딘', '어벤져스: 엔드게임', '교회오빠'], ['레드슈즈', '타워', '작전', '교회오빠'], ['신과함께-죄와 벌', '군도:민란의 시대', '그녀', '교회오빠'], ['광해, 왕이 된 남자', '블랙', '교회오빠'], ['W (더블유)', '교회오빠'], ['서치', '교회오빠'], ['손님', '교회오빠'], ['분노의 질주: 더 세븐', '여고괴담 5', '남극일기', '남극일기', '교회오빠'], ['감쪽같은 그녀', '기생충', '교회오빠'], ['아논', '저스티스 리그', '쿵푸 트래블러 : 남권', '성냥팔이 소녀의 재림', '콜로설', '그레이트 월', '건축학개론', '그 사람 그 사랑 그 세상', '몽키킹:손오공의 탄생', '교회오빠'], ['패션왕', '교회오빠'], ['인크레더블 2', '교회오빠'], ['오두막', '검사외전', '셜록: 유령신부', '스타워즈: 깨어난 포스', '헝거게임 : 더 파이널', '마션', '메이즈 러너: 스코치 트라이얼', '미쓰 와이프', '미니언즈', '교회오빠'], ['그린 북', '더 와이프', '가버나움', '로마', '바울', '체실 비치에서', '어느 가족', '교회오빠'], ['미씽: 사라진 여자', '국제시장', '나를 찾아줘', '루퍼', '교회오빠'], ['26년', '교회오빠'], ['봉오동 전투', '어벤져스: 엔드게임', '안시성', '인천상륙작전', '교회오빠'], ['고산자, 대동여지도', '천안함 프로젝트', '깡철이', '남영동1985', '범죄와의 전쟁 : 나쁜놈들 전성시대', '그대를 사랑합니다', '라스트 갓파더', '용서는 없다', '아바타', '교회오빠'], ['그 시절, 우리가 좋아했던 소녀', '백야행 - 하얀 어둠 속을 걷다', '나는 비와 함께 간다', '쿨 러닝', '순정만화', '말할 수 없는 비밀', '교회오빠'], ['어벤져스: 엔드게임', '부산행', '아메리칸 스나이퍼', '조선미녀삼총사', '교회오빠'], ['더 넌', '마션', '어벤져스: 에이지 오브 울트론', '인터스텔라', '해적: 바다로 간 산적', '교회오빠'], ['스파이더맨: 파 프롬 홈', '공동경비구역 JSA', '사바하', '그것만이 내 세상', '배심원들', '말모이', '국가부도의 날', '창궐', '부라더', '교회오빠'], ['82년생 김지영', '걸캅스', '교회오빠'], ['데드풀 2', '택시운전사', '청년경찰', '슈퍼배드 3', '박열', '임금님의 사건수첩', '신비한 동물사전', '럭키', '오빠생각', '교회오빠'], ['기생충', '교회오빠'], ['러빙 빈센트', '바울', '교회오빠'], ['어벤져스: 엔드게임', '비긴 어게인', '엘리시움', '교회오빠'], ['군함도', '교회오빠'], ['안나', '극한직업', '말모이', '레버넌트: 죽음에서 돌아온 자', '교회오빠'], ['뽀로로 극장판 보물섬 대모험', '변호인', '교회오빠'], ['콩: 스컬 아일랜드', '너의 이름은.', '아일랜드', '교회오빠'], ['아이 필 프리티', '위대한 쇼맨', '이프 온리', '택시운전사', '라라랜드', '마스터', '미라클 프롬 헤븐', '설국열차', '설국열차', '교회오빠'], ['기생충', '베놈', '협상', '어벤져스: 인피니티 워', '지금 만나러 갑니다', '교회오빠'], ['출국', '명왕성', '마이웨이', '국가대표', '교회오빠'], ['나의 소녀시대', '교회오빠'], ['어벤져스: 엔드게임', '스타 이즈 본', '곡성(哭聲)', '그레이의 50가지 그림자', '교회오빠'], ['어바웃 타임', '교회오빠'], ['스윙키즈', '크레이지 리치 아시안', '코코', '공조', '꼬마참새 리차드: 아프리카 원정대', '교회오빠'], ['캡틴 아메리카: 시빌 워', '데드풀', '교회오빠'], ['알라딘', '안시성', '다크 나이트', '교회오빠'], ['아쿠아맨', '내안의 그놈', '사바하', '국가부도의 날', '서치', '업그레이드', '해피 데스데이', '월요일이 사라졌다', '마녀', '교회오빠'], ['위플래쉬', '암살교실', '김전일 소년 사건부 옥문학원 살인사건', '변호인', '아이언맨 3', '성균관 스캔들', '아바타', '교회오빠'], ['겨울왕국 2', '반딧불이의 묘', '조커', '호밀밭의 반항아', '애드 아스트라', '미션 임파서블 3', '드롭박스', '노아', '신이 보낸 사람', '교회오빠'], ['걸캅스', '항거:유관순 이야기', '안시성', '교회오빠'], ['비긴 어게인', '여름애(愛)', '지구가 멈추는 날', '죽은 시인의 사회', '교회오빠'], ['이웃집 토토로', '말모이', '미션 임파서블: 폴아웃', '신과함께-인과 연', '모아나', '씽', '앵그리버드 더 무비', '굿 다이노', '파리오페라발레 갈라쇼  ', '교회오빠'], ['극한직업', '곡성(哭聲)', '교회오빠'], ['애드 아스트라', '라라랜드', '불의 전차', '교회오빠'], ['미쓰백', '교회오빠'], ['기생충', '바울', '교회오빠'], ['어벤져스: 엔드게임', '미성년', '교회오빠'], ['맘마미아!2', '교회오빠'], ['어벤져스: 엔드게임', '교회오빠'], ['증인', '바울', '교회오빠'], ['미안해요, 리키', '파비안느에 관한 진실', '프란치스코 교황: 맨 오브 히스 워드', '더 컨덕터', '말레피센트 2', '100일 동안 100가지로 100퍼센트 행복찾기', '나쁜 녀석들: 더 무비', '타짜: 원 아이드 잭', '그것: 두 번째 이야기', '벌새', '교회오빠'], ['신이 보낸 사람', '교회오빠'], ['완벽한 타인', '타샤 튜더', '어벤져스: 인피니티 워', '노무현입니다', '두근두근 내 인생', '피아니스트 세이모어의 뉴욕 소네트', '인간중독', '나의 PS 파트너', '전우치', '교회오빠'], ['가장 보통의 연애', '완벽한 타인', '싱 오버 미', '교회오빠'], ['더 프레데터', '미이라', '당신, 거기 있어줄래요', '잭 리처: 네버 고 백', '럭키', '특종: 량첸살인기', '교회오빠'], ['가버나움', '콜드 워', '교회오빠'], ['변산', '더 리더: 책 읽어주는 남자', '1987', '국제시장', '말할 수 없는 비밀', '교회오빠'], ['유열의 음악앨범', '숨바꼭질', '교회오빠'], ['가버나움', '교회오빠'], ['라스트 크리스마스', '파울볼', '애니멀', '세 얼간이', '교회오빠'], ['극한직업', '너의 이름은.', '노무현입니다', '럭키', '인천상륙작전', '터널', '밀정', '히말라야', '검사외전', '교회오빠'], ['하나와 미소시루', '타이타닉', '무방비 도시', '태양의 노래', '교회오빠'], ['천로역정: 천국을 찾아서', '폴란드로 간 아이들', '바울', '교회오빠'], ['천로역정: 천국을 찾아서', '알라딘', '옥자', '교회오빠'], ['말모이', '교회오빠'], ['웜 바디스', '수퍼내추럴 시즌1', '교회오빠'], ['그물', '제이슨 본', '캡틴 필립스', '클라우즈 오브 실스마리아', '천번의 굿나잇', '사도', '엑소더스: 신들과 왕들', '감시자들', '인 트리트먼트', '교회오빠'], ['유열의 음악앨범', '극한직업', '말모이', '매드맥스: 분노의 도로', '판도라', '닥터 스트레인지', '벤허', '인천상륙작전', '부산행', '교회오빠'], ['라이온 킹', '아이 캔 스피크', '슈퍼배드 3', '굿바이 싱글', '클래식', '이미테이션 게임', '인터스텔라', '연애시대', '백야행 - 하얀 어둠 속을 걷다', '교회오빠'], ['아픈 만큼 사랑한다', '교회오빠'], ['미성년', '교회오빠'], ['화이트 하우스 다운', '괜찮아, 사랑이야', '교회오빠'], ['바닷마을 다이어리', '소셜포비아', '들개', '교회오빠'], ['스파이더맨: 파 프롬 홈', '기생충', '신과함께-죄와 벌', '군함도', '예수는 역사다', '노무현입니다', '공조', '캡틴 아메리카: 시빌 워', '교회오빠'], ['동주', '하치 이야기', '그대를 사랑합니다', '그 여자 작사 그 남자 작곡', '포레스트 검프', '그렇게 아버지가 된다', '굿 윌 헌팅', '교회오빠'], ['어벤져스: 엔드게임', '교회오빠'], ['수상한 그녀', '교회오빠'], ['겨울왕국 2', '82년생 김지영', '분노의 질주: 홉스&쇼', '알라딘', '기생충', '극한직업', '국가부도의 날', '보헤미안 랩소디', '위대한 쇼맨', '교회오빠'], ['암전', '봉오동 전투', '엑시트', '스파이더맨: 파 프롬 홈', '천로역정: 천국을 찾아서', '기생충', '어벤져스: 엔드게임', '걸캅스', '안시성', '교회오빠'], ['더 지니어스: 게임의 법칙', '교회오빠'], ['사랑하기 때문에', '교회오빠'], ['지금 만나러 갑니다', '히말라야', '교회오빠'], ['플레이모빌: 더 무비', '엑시트', '앵그리 버드 2: 독수리 왕국의 침공', '토이 스토리 4', '알라딘', '주먹왕 랄프 2: 인터넷 속으로', '스파이더맨: 뉴 유니버스', '앤트맨과 와스프', '카3: 새로운 도전', '교회오빠'], ['알라딘', '라라', '반짝이는 박수 소리', '비긴 어게인', '내 심장을 쏴라', '숨바꼭질', '교회오빠'], ['천로역정: 천국을 찾아서', '레드: 더 레전드', '수상한 그녀', '블랙 스완', '교회오빠'], ['사일런스', '알라딘', '노무현입니다', '언브로큰', '미녀와 야수', '울지마 톤즈', '교회오빠'], ['스플릿', '교회오빠'], ['증인', '교회오빠'], ['포드 V 페라리', '겨울왕국 2', '기생충', '나쁜 녀석들: 더 무비', '엑시트', '신과함께-인과 연', '신과함께-죄와 벌', '옥자', '아이 캔 스피크', '교회오빠'], ['13년의 공백', '캐리비안의 해적: 죽은 자는 말이 없다', '태풍이 지나가고', '교회오빠'], ['변신', '더 넌', '히말라야', '부활', '동주', '무간도', '광해, 왕이 된 남자', '이웃사람', '점쟁이들', '교회오빠'], ['애프터', '교회오빠'], ['카페, 한 사람을 기다리다', '교회오빠'], ['고흐, 영원의 문에서', '시동', '두 교황', '포드 V 페라리', '블랙머니', '신의 한 수: 귀수편', '82년생 김지영', '예스터데이', '힘을 내요, 미스터 리', '벌새', '교회오빠'], ['내 이름은 김삼순', '그들이 사는 세상', '그들이 사는 세상', '굿모닝 프레지던트', '시간 여행자의 아내', '워낭소리', '백만장자의 첫사랑', '교회오빠'], ['알라딘', '토이 스토리 4', '미성년', '교회오빠'], ['명탐정 코난 : 제로의 집행인', '어바웃 타임', '교회오빠'], ['곡성(哭聲)', '주토피아', '내 사랑 내 곁에', '교회오빠'], ['과속스캔들', '21', '원스 어폰 어 타임', '어거스트 러쉬', '교회오빠'], ['스포트라이트', '미라클 프롬 헤븐', '천로역정: 천국을 찾아서', '위대한 쇼맨', '교회오빠'], ['라이온 킹', '교회오빠'], ['김복동', '김복동', '자백', '교회오빠'], ['가장 보통의 연애', '알라딘', '교회오빠'], ['82년생 김지영', '해피 데스데이 2 유', '교회오빠'], ['이디오크러시', '푸시', '어거스트 러쉬', '플라이 대디', '교회오빠'], ['덕혜옹주', '교회오빠'], ['극한직업', '교회오빠'], ['완벽한 타인', '교회오빠'], ['기생충', '그린 북', '뽀로로 극장판 공룡섬 대모험', '본 얼티메이텀', '교회오빠'], ['미드웨이', '기도의 힘', '어벤져스', '교회오빠'], ['예수는 역사다', '교회오빠'], ['보희와 녹양', '완득이', '완득이', '교회오빠'], ['82년생 김지영', '엑시트', '배심원들', '청년경찰', 'Mr. 로빈 꼬시기', '교회오빠'], ['예스터데이', '천로역정: 천국을 찾아서', '기생충', '교회오빠'], ['쎄시봉', '교회오빠'], ['시체가 돌아왔다', '교회오빠'], ['보헤미안 랩소디', '교회오빠'], ['재심', '공조', '신은 죽지 않았다', '오늘의 연애', '인터스텔라', '명량', '정준영의 Be Stupid', '스타 베이비시터 날 보러와요', '해피선데이-1박 2일 시즌3', '교회오빠'], ['미쓰 와이프', '군도:민란의 시대', '교회오빠'], ['어벤져스: 엔드게임', '알라딘', '기생충', '엑시트', '장사리 : 잊혀진 영웅들', '가장 보통의 연애', '어벤져스: 인피니티 워', '신과함께-죄와 벌', '남한산성', '교회오빠'], ['아픈 만큼 사랑한다', '루스 베이더 긴즈버그 : 나는 반대한다', '교회오빠'], ['안시성', '인천상륙작전', '교회오빠']]
#%%
values = []
for i in range(len(lst)):
    values.append(pd.DataFrame({"ID":i , "name":lst[i],'point':1}))
#%%
data = pd.concat(values)
data
#%%
matrix = data.pivot_table(index='ID', columns='name', values='point')
matrix.head(20)
#%%
matrix.to_excel(urls + "saveExcel.xlsx")
data = pd.read_excel(urls + "새 폴더/list.xlsx")
#%%
frequent_itemsets = apriori(data, min_support=0.01, use_colnames=True)
print(frequent_itemsets)
#%%
frequent_itemsets2 = frequent_itemsets.sort_values(by=['support'], axis=0, ascending=False)
frequent_itemsets2.head(10)